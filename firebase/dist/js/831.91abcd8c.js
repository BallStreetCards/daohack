"use strict";(self["webpackChunkapp"]=self["webpackChunkapp"]||[]).push([[831],{5590:(e,t,a)=>{a.d(t,{IA:()=>n,Lu:()=>r});var l=a(1114),o=a(5533);function n(){return(0,o.Ab)("",l.D4)}function r(e,t=(()=>({}))){return(0,o.Ab)((()=>{const a=t();return a?[e,a]:void 0}),l.Ey)}},613:(e,t,a)=>{a.d(t,{II:()=>d,xJ:()=>u});var l=a(8925),o=a(5590),n=a(5533);function r(){return(0,n.Ab)("",l.E0)}function d(e=l.it,t={viewMethods:[],changeMethods:["propose","vote","execute"]}){const a=r();return(0,n.Ab)((()=>a.data.value?[a.data.value.near,a.data.value.wallet,e,t]:void 0),l.uN)}function u(){const e=r(),t=(0,o.IA)();return(0,n.Ab)((()=>e.data.value?[e.data.value.near,e.data.value.wallet,e.data.value.keyStore,t.data.value]:void 0),l.ts)}},8831:(e,t,a)=>{a.r(t),a.d(t,{default:()=>Ce});var l=a(3673),o=a(2323);const n={class:"container q-mx-auto q-px-lg q-mt-lg"},r={key:0},d={key:0},u={class:"text-h4"},i={class:"row q-col-gutter-md q-mt-md"},c={class:"col col-sm-5"},s={class:"col col-sm-7"},m={style:{margin:"0"}},p=(0,l.Uk)("Supply"),f=(0,l.Uk)(" Market cap"),v=(0,l.Uk)(" Details"),g=(0,l._)("br",null,null,-1),w={style:{"font-size":"70%"}},k={key:0},b=(0,l.Uk)(" Waiting for voting to start... "),y=(0,l.Uk)(" Cast your vote "),_=(0,l.Uk)(" YES "),q=(0,l.Uk)(" NO "),U=(0,l.Uk)(" Waiting for community votes... "),I=(0,l.Uk)(" votes received "),W=(0,l.Uk)(" Next: "),h=(0,l.Uk)("Mint card & establish sub-DAO"),Z=(0,l.Uk)("Cancel proposal"),C={key:4},V=(0,l.Uk)(" Minting your card and establishing its DAO... "),D={key:5},S=(0,l.Uk)(" Congratulations! Your new "),P=(0,l._)("a",{href:""},"DAO",-1),Q=(0,l.Uk)(" is online "),x=(0,l.Uk)("DONE"),j={key:1},A=(0,l._)("div",{class:"text-h4"},"Create DAO proposal",-1),M={class:"row q-col-gutter-md"},L={class:"col-12 col-sm-4 col-md-6"},O={class:"col-12 col-sm-8 col-md-6 q-col-gutter-y-md"},z={class:"q-mt-md"},N=(0,l.Uk)("Create proposal");function R(e,t,a,R,H,B){const Y=(0,l.up)("q-img"),F=(0,l.up)("q-item-section"),E=(0,l.up)("q-item"),J=(0,l.up)("q-list"),G=(0,l.up)("q-banner"),K=(0,l.up)("q-btn"),T=(0,l.up)("q-input"),$=(0,l.up)("q-card-section"),X=(0,l.up)("q-card"),ee=(0,l.up)("media-input"),te=(0,l.up)("q-page");return(0,l.wg)(),(0,l.j4)(te,null,{default:(0,l.w5)((()=>[(0,l._)("div",n,[e.currentUser?((0,l.wg)(),(0,l.iD)("div",r,[e.proposals&&e.proposals.size?((0,l.wg)(),(0,l.iD)("div",d,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(e.proposals,(([a,n])=>((0,l.wg)(),(0,l.j4)(X,{key:a,bordered:"",flat:"",class:"q-pa-md"},{default:(0,l.w5)((()=>{var r,d,j,A,M;return[(0,l._)("div",u,"DAO proposal #"+(0,o.zw)(n.proposalId),1),(0,l._)("div",i,[(0,l._)("div",c,[(0,l.Wm)(Y,{class:"bg-grey-2",src:n.cardImg},null,8,["src"])]),(0,l._)("div",s,[(0,l._)("h5",m,(0,o.zw)(n.cardName),1),(0,l.Wm)(J,{bordered:"",separator:""},{default:(0,l.w5)((()=>[(0,l.Wm)(E,null,{default:(0,l.w5)((()=>[(0,l.Wm)(F,null,{default:(0,l.w5)((()=>[p])),_:1}),(0,l.Wm)(F,null,{default:(0,l.w5)((()=>[(0,l.Uk)(" 100 tokens @ "+(0,o.zw)(n.listedPrice/100)+" Ⓝ ",1)])),_:2},1024)])),_:2},1024),(0,l.Wm)(E,null,{default:(0,l.w5)((()=>[(0,l.Wm)(F,null,{default:(0,l.w5)((()=>[f])),_:1}),(0,l.Wm)(F,null,{default:(0,l.w5)((()=>[(0,l.Uk)((0,o.zw)(n.listedPrice)+" Ⓝ ",1)])),_:2},1024)])),_:2},1024),(0,l.Wm)(E,null,{default:(0,l.w5)((()=>[(0,l.Wm)(F,null,{default:(0,l.w5)((()=>[v,g,(0,l._)("div",w,(0,o.zw)(n),1)])),_:2},1024)])),_:2},1024)])),_:2},1024),"drafted"===n.status?((0,l.wg)(),(0,l.iD)("div",k,[(0,l.Wm)(G,{rounded:"",class:"q-mt-lg bg-grey-3"},{default:(0,l.w5)((()=>[b])),_:1})])):(0,l.kq)("",!0),"proposed"===n.status&&n.account!==(null===(r=e.currentUser)||void 0===r?void 0:r.accountId)?((0,l.wg)(),(0,l.j4)(X,{key:1,class:"q-mt-lg"},{default:(0,l.w5)((()=>[(0,l.Wm)($,null,{default:(0,l.w5)((()=>[y,(0,l.Wm)(K,{flat:"",color:"green",onClick:t=>e.vote(n.proposalId,!0,e.reason,a)},{default:(0,l.w5)((()=>[_])),_:2},1032,["onClick"]),(0,l.Wm)(K,{flat:"",color:"red",onClick:t=>e.vote(n.proposalId,!1,e.reason,a)},{default:(0,l.w5)((()=>[q])),_:2},1032,["onClick"]),(0,l.Wm)(T,{label:"Optional reason for vote decision",modelValue:e.reason,"onUpdate:modelValue":t[0]||(t[0]=t=>e.reason=t)},null,8,["modelValue"])])),_:2},1024)])),_:2},1024)):(0,l.kq)("",!0),["proposed","voted"].indexOf(n.status)>=0&&n.account===(null===(d=e.currentUser)||void 0===d?void 0:d.accountId)?((0,l.wg)(),(0,l.j4)(G,{key:2,rounded:"",class:(0,o.C_)(["q-mt-lg",n.votes?"bg-green-3":"bg-grey-3"])},{default:(0,l.w5)((()=>[U,(0,l._)("b",null,(0,o.zw)(n.votes||0),1),I])),_:2},1032,["class"])):(0,l.kq)("",!0),"voted"===n.status&&n.account===(null===(j=e.currentUser)||void 0===j?void 0:j.accountId)?((0,l.wg)(),(0,l.j4)(X,{key:3,flat:"",bordered:"",class:"q-mt-lg"},{default:(0,l.w5)((()=>[(0,l.Wm)($,null,{default:(0,l.w5)((()=>[W,n.approved?((0,l.wg)(),(0,l.j4)(K,{key:0,flat:"",color:"green",onClick:t=>e.mint(a)},{default:(0,l.w5)((()=>[h])),_:2},1032,["onClick"])):(0,l.kq)("",!0),(0,l.Wm)(K,{flat:"",onClick:t=>e.done(a)},{default:(0,l.w5)((()=>[Z])),_:2},1032,["onClick"])])),_:2},1024)])),_:2},1024)):(0,l.kq)("",!0),"mint"===n.status&&n.account===(null===(A=e.currentUser)||void 0===A?void 0:A.accountId)?((0,l.wg)(),(0,l.iD)("div",C,[(0,l.Wm)(G,{rounded:"",class:"q-mt-lg bg-grey-3"},{default:(0,l.w5)((()=>[V])),_:1})])):(0,l.kq)("",!0),"executed"===n.status&&n.account===(null===(M=e.currentUser)||void 0===M?void 0:M.accountId)?((0,l.wg)(),(0,l.iD)("div",D,[(0,l.Wm)(G,{rounded:"",class:"q-my-lg bg-green-3"},{action:(0,l.w5)((()=>[(0,l.Wm)(K,{flat:"",onClick:t=>e.done(a)},{default:(0,l.w5)((()=>[x])),_:2},1032,["onClick"])])),default:(0,l.w5)((()=>[S,P,Q])),_:2},1024)])):(0,l.kq)("",!0)])])]})),_:2},1024)))),128))])):((0,l.wg)(),(0,l.iD)("div",j,[A,(0,l.Wm)(X,{bordered:"",flat:"",class:"q-pa-md q-mt-lg"},{default:(0,l.w5)((()=>[(0,l._)("div",M,[(0,l._)("div",L,[(0,l.Wm)(Y,{class:"bg-grey-2",src:e.form.cardImg},null,8,["src"])]),(0,l._)("div",O,[(0,l.Wm)(T,{label:"Card name",modelValue:e.form.cardName,"onUpdate:modelValue":t[1]||(t[1]=t=>e.form.cardName=t)},null,8,["modelValue"]),(0,l._)("div",null,[(0,l.Wm)(ee,{label:"Card image",modelValue:e.form.cardImg,"onUpdate:modelValue":t[2]||(t[2]=t=>e.form.cardImg=t)},null,8,["modelValue"])]),(0,l.Wm)(T,{label:"Card verification URL",modelValue:e.form.cardVerificationURL,"onUpdate:modelValue":t[3]||(t[3]=t=>e.form.cardVerificationURL=t)},null,8,["modelValue"]),(0,l.Wm)(T,{type:"number",label:"Card value (NEAR)",modelValue:e.form.listedPrice,"onUpdate:modelValue":t[4]||(t[4]=t=>e.form.listedPrice=t)},null,8,["modelValue"]),(0,l._)("div",z,[(0,l.Wm)(K,{class:"fit bg-orange text-white q-py-sm",flat:"",border:"",onClick:e.submitProposal},{default:(0,l.w5)((()=>[N])),_:1},8,["onClick"])])])])])),_:1})]))])):(0,l.kq)("",!0)])])),_:1})}function H(e,t,a,o,n,r){const d=(0,l.up)("image-renderer"),u=(0,l.up)("q-item-section"),i=(0,l.up)("q-file"),c=(0,l.up)("q-spinner"),s=(0,l.up)("boolean-renderer"),m=(0,l.up)("q-btn"),p=(0,l.up)("q-item");return(0,l.wg)(),(0,l.j4)(p,{class:"q-pt-none q-pa-none"},{default:(0,l.w5)((()=>[e.modelValue?((0,l.wg)(),(0,l.j4)(u,{key:0,avatar:""},{default:(0,l.w5)((()=>[(0,l.Wm)(d,{content:e.modelValue},null,8,["content"])])),_:1})):(0,l.kq)("",!0),(0,l.Wm)(u,null,{default:(0,l.w5)((()=>[(0,l.Wm)(i,(0,l.dG)({modelValue:e.uploadFile,"onUpdate:modelValue":t[0]||(t[0]=t=>e.uploadFile=t),type:"file",label:e.label},e.$attrs),null,16,["modelValue","label"])])),_:1}),(0,l.Wm)(u,{side:""},{default:(0,l.w5)((()=>[e.isLoading?((0,l.wg)(),(0,l.j4)(c,{key:0})):((0,l.wg)(),(0,l.j4)(s,{key:1,content:e.uploadStatus},null,8,["content"]))])),_:1}),(0,l.Wm)(u,{side:""},{default:(0,l.w5)((()=>[(0,l.Wm)(m,{disabled:!e.uploadFile,onClick:e.upload,label:"Upload",color:"primary"},null,8,["disabled","onClick"])])),_:1})])),_:1})}var B=a(5720),Y=(a(6466),a(1959));function F(e,t,a,o,n,r){const d=(0,l.up)("q-icon");return e.content?((0,l.wg)(),(0,l.j4)(d,{key:0,name:"done",color:"positive",size:"2rem"})):void 0!==e.content?((0,l.wg)(),(0,l.j4)(d,{key:1,name:"close",size:"2rem"})):(0,l.kq)("",!0)}const E=(0,l.aZ)({name:"BooleanRenderer",props:{content:Boolean},setup(){return{}}});var J=a(4260),G=a(4554),K=a(7518),T=a.n(K);const $=(0,J.Z)(E,[["render",F]]),X=$;function ee(e,t,a,o,n,r){const d=(0,l.up)("q-img");return(0,l.wg)(),(0,l.j4)(d,{src:e.content,fit:"contain"},null,8,["src"])}T()(E,"components",{QIcon:G.Z});const te=(0,l.aZ)({name:"ImageRenderer",props:{content:String}});var ae=a(4027);const le=(0,J.Z)(te,[["render",ee]]),oe=le;T()(te,"components",{QImg:ae.Z});var ne=a(1082),re=function(e,t,a,l){function o(e){return e instanceof a?e:new a((function(t){t(e)}))}return new(a||(a=Promise))((function(a,n){function r(e){try{u(l.next(e))}catch(t){n(t)}}function d(e){try{u(l["throw"](e))}catch(t){n(t)}}function u(e){e.done?a(e.value):o(e.value).then(r,d)}u((l=l.apply(e,t||[])).next())}))};const de=(0,l.aZ)({name:"MediaInput",components:{BooleanRenderer:X,ImageRenderer:oe},props:{label:String,modelValue:String,fieldPath:String,uploadPath:String},emits:["update:modelValue"],setup(e,{emit:t}){const a=(0,Y.iH)(),o=(0,Y.iH)(!1),n=(0,Y.iH)(),r=(0,l.Fl)((()=>{var t;return(e.uploadPath||":path/:date-:name").replace(/:path\b/,e.fieldPath||"").replace(/:date\b/,ne.ZP.formatDate(Date.now(),"YYYYMMDD-HHMMSS")).replace(/:name\b/,(null===(t=a.value)||void 0===t?void 0:t.name)||"")}));function d(){return re(this,void 0,void 0,(function*(){if(a.value){o.value=!0,n.value=!1;try{const e=B.Z.storage().ref(r.value),l=yield e.put(a.value),d=yield l.ref.getDownloadURL();t("update:modelValue",d),a.value=void 0,n.value=!0}finally{o.value=!1}}}))}return{isLoading:o,uploadFile:a,uploadStatus:n,upload:d,path:r}}});var ue=a(3414),ie=a(2035),ce=a(6239),se=a(9754),me=a(2165);const pe=(0,J.Z)(de,[["render",H]]),fe=pe;T()(de,"components",{QItem:ue.Z,QItemSection:ie.Z,QFile:ce.Z,QSpinner:se.Z,QBtn:me.Z});var ve=a(6495),ge=(a(8064),a(5590)),we=a(613),ke=function(e,t,a,l){function o(e){return e instanceof a?e:new a((function(t){t(e)}))}return new(a||(a=Promise))((function(a,n){function r(e){try{u(l.next(e))}catch(t){n(t)}}function d(e){try{u(l["throw"](e))}catch(t){n(t)}}function u(e){e.done?a(e.value):o(e.value).then(r,d)}u((l=l.apply(e,t||[])).next())}))};const be=(0,l.aZ)({name:"PageIndex",components:{MediaInput:fe},setup(){const{data:e}=(0,we.II)(),{data:t}=(0,we.xJ)(),{data:a}=(0,ge.Lu)("proposals",(()=>({}))),l=(0,Y.iH)({cardName:"2020-21 Panini Select - Teal White Pink #63 LaMelo Ball SN49",cardImg:"",cardVerificationURL:"https://www.psacard.com/cert/63594751",listedPrice:"1337",status:"drafted"}),o=(0,Y.iH)(""),n=()=>ke(this,void 0,void 0,(function*(){var e;yield ve.Z.firestore().collection("proposals").add(Object.assign(Object.assign({},l.value),{account:null===(e=t.value)||void 0===e?void 0:e.accountId})),l.value.cardImg=""})),r=e=>ke(this,void 0,void 0,(function*(){yield ve.Z.firestore().collection("proposals").doc(e).delete()})),d=e=>ke(this,void 0,void 0,(function*(){yield ve.Z.firestore().collection("proposals").doc(e).update({status:"mint"})})),u=(e,a,l,o)=>ke(this,void 0,void 0,(function*(){var n;yield ve.Z.firestore().collection("votes").add({docId:o,proposalId:e,approve:a,reason:l,account:null===(n=t.value)||void 0===n?void 0:n.accountId})}));return{form:l,submitProposal:n,proposals:a,vote:u,reason:o,mint:d,currentUser:t,near:e,done:r}}});var ye=a(4379),_e=a(151),qe=a(5869),Ue=a(7011),Ie=a(5607),We=a(5589),he=a(2426);const Ze=(0,J.Z)(be,[["render",R]]),Ce=Ze;T()(be,"components",{QPage:ye.Z,QCard:_e.Z,QImg:ae.Z,QSeparator:qe.Z,QList:Ue.Z,QItem:ue.Z,QItemSection:ie.Z,QBanner:Ie.Z,QCardSection:We.Z,QBtn:me.Z,QInput:he.Z})}}]);